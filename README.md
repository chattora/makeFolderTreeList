# makeFolderTreeList

任意のフォルダをルートとしてGoogleドライブ内のフォルダ階層をリスト化するGAS。

## 使用方法
1.ドライブIDかフォルダIDを入力画面から入力する
2.出力モードを選択する
3.実行
4.開始メールが送信される  
5.処理が終わると終了メールが送信されシートが作成される  

## 仕様
・初回起動でTRIGGER_FUNCで指定された時間後にトリガーが設定され、開始メールを送信  
・最初のトリガー時に"processProgress"というファイル名の設定ファイルを作成する  
・その後はMAX_EXECUTION_TIMEで設定された時間を処理をし、処理が完了していない場合は完了まで再度トリガーを設定する。  

### データ
データそのものを保持をすると膨大なデータ量になるため、データはタイムアップ処理ごとにシートに出力する。  
中断後再帰的な処理を行うためfolderQueueにフォルダIDとレイヤーを保持している。  
folderQueue: [{ id:id,layer:layer }],  
→id:フォルダid  
→layer:階層レイヤー（深度）  

## デバッグ仕様
・デバッグ用にJSON形式で保存したデータをdebugProperties.txtというファイルでマイドライブに出力している　。  
→ 出力したい場合はdegug.gsの定数DEBUGにtrueを代入してください。
・デバッグ様にログをスプレッドシートに出力する。出力したい場合は、LOG_PUTにtrueを代入してください。
・途中で処理を停止した場合、保存データが残っていると最初から処理が始まらないので、その場合はフォルダIDを入力欄に"リセット"と入力。
・フォルダID欄に”マイドライブ"と入力するとマイドライブ内の階層化リストを出力する。
トリガー確認　→ https://script.google.com/home/

